(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{7722:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return t(8480)}])},8480:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return m}});var s=t(5893),a=t(7294),i=t(6154),c=t(3920),r=t(1256),o=t(5568),u=t(629),l=t(7209),d=t(3321),h=t(6307);function m(){let[e,n]=(0,a.useState)(""),[t,m]=(0,a.useState)(!1),[g,p]=(0,a.useState)([]),[f,x]=(0,a.useState)("Guest");(0,a.useEffect)(()=>{x(localStorage.getItem("id"));let e=c.ZP.connect({path:"/api/chat/socketio"});if(e.on("connect",()=>{console.log("SOCKET CONNECTED!",e.id),m(!0)}),e.on("message",e=>{g.push(e),p([...g])}),e)return()=>e.disconnect()},[]);let v=(0,a.useCallback)(e=>{n(e.target.value)},[e]),_=e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),j(e))},j=async t=>{t.preventDefault(),e&&(await i.Z.post("/api/chat",{user:f,message:e}),n(""))};return(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)(r.Z,{spacing:2,direction:"column",children:[(0,s.jsx)(o.Z,{severity:"info",children:"채팅 기능은 로그인된 유저에게만 제공됩니다."}),(0,s.jsx)(r.Z,{spacing:2,direction:"column",children:(0,s.jsx)(u.Z,{variant:"outlined",sx:{minHeight:"300px"},children:g.length?g.map((e,n)=>(0,s.jsxs)("div",{className:"chat-message",children:[e.user," : ",e.message]},n)):(0,s.jsx)("div",{className:"alert-message",children:"채팅을 시작합니다"})})}),(0,s.jsxs)(r.Z,{spacing:1,direction:"row",children:[(0,s.jsx)(l.Z,{id:"chat-message-input",label:"enter your message",variant:"outlined",value:e,onChange:v,margin:"normal",autoFocus:!0,multiline:!0,rows:2,fullWidth:!0,onKeyPress:_,placeholder:t?"enter your message":"Connecting...\uD83D\uDD50"}),(0,s.jsx)(d.Z,{type:"submit",variant:"contained",color:"primary",endIcon:(0,s.jsx)(h.Z,{}),onClick:j,children:"Send"})]})]})})}}},function(e){e.O(0,[713,774,888,179],function(){return e(e.s=7722)}),_N_E=e.O()}]);